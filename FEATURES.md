# 功能特性清单

## ✅ 已实现功能

### 后端功能

#### 1. 项目管理
- ✅ 创建项目
- ✅ 列出所有项目
- ✅ 获取项目详情
- ✅ 删除项目

#### 2. 类别管理
- ✅ 创建类别（名称、颜色、快捷键）
- ✅ 列出项目所有类别

#### 3. 图像管理
- ✅ 列出项目所有图像
- ✅ 获取图像详情（含标注）
- ✅ 图像文件服务（通过 HTTP 访问）

#### 4. 标注管理
- ✅ 创建标注（矩形框、多边形、关键点）
- ✅ 更新标注
- ✅ 删除标注
- ✅ 自动更新图像状态（UNLABELED/LABELED）

#### 5. MQTT 集成
- ✅ 订阅 MQTT Topic (`annotator/upload/{project_id}`)
- ✅ 解析 JSON 消息
- ✅ Base64 图像解码
- ✅ 图像存储到文件系统
- ✅ 自动写入数据库
- ✅ 响应消息发送
- ✅ WebSocket 通知前端

#### 6. WebSocket 实时通信
- ✅ WebSocket 连接管理
- ✅ 按项目分组连接
- ✅ 广播消息到所有客户端
- ✅ 新图像到达通知

#### 7. YOLO 导出
- ✅ 坐标归一化转换
- ✅ 支持矩形框格式
- ✅ 支持多边形格式
- ✅ 生成标准 YOLO 格式文件
- ✅ 导出目录结构（images/, labels/, classes.txt）

#### 8. 数据库模型
- ✅ Project 模型
- ✅ Image 模型
- ✅ Class 模型
- ✅ Annotation 模型
- ✅ SQLite 数据库初始化

### 前端功能

#### 1. 项目选择界面
- ✅ 项目列表显示
- ✅ 创建新项目
- ✅ 选择项目进入标注工作台

#### 2. 标注工作台界面
- ✅ 三栏式布局（工具栏 + 画布 + 控制面板）
- ✅ 响应式设计

#### 3. 工具栏
- ✅ 选择工具
- ✅ 矩形框工具
- ✅ 多边形工具
- ✅ 关键点工具
- ✅ 工具快捷键提示

#### 4. Canvas 画布
- ✅ 图像显示
- ✅ 鼠标滚轮缩放（以鼠标位置为中心）
- ✅ Space + 拖拽平移
- ✅ 鼠标中键平移
- ✅ 十字准星跟随鼠标
- ✅ 图像信息显示（文件名、分辨率）

#### 5. 矩形框标注
- ✅ 鼠标拖拽绘制
- ✅ 拖拽时虚线预览
- ✅ 完成后实线显示
- ✅ 类别颜色填充（半透明）
- ✅ 自动保存到服务器

#### 6. 多边形标注
- ✅ 点击添加顶点
- ✅ 预览下一条边
- ✅ 双击或 Enter 闭合
- ✅ Esc 撤销上一个点
- ✅ 显示所有顶点
- ✅ 自动保存到服务器

#### 7. 关键点标注
- ✅ 依次点击标记关键点
- ✅ 显示点标记
- ✅ 自动保存到服务器

#### 8. 标注编辑
- ✅ 点击选中标注
- ✅ 选中高亮显示
- ✅ 显示标注列表
- ✅ 删除选中标注

#### 9. 控制面板
- ✅ 标注列表标签
  - 显示所有标注
  - 显示类别和颜色
  - 点击选中标注
- ✅ 类别标签
  - 显示所有类别
  - 创建新类别
  - 颜色选择器
- ✅ 文件导航标签
  - 图像列表
  - 标注状态指示（绿点/灰点）
  - 点击切换图像

#### 10. 键盘快捷键
- ✅ `R`: 矩形框工具
- ✅ `P`: 多边形工具
- ✅ `V`: 选择工具
- ✅ `K`: 关键点工具
- ✅ `A` / `←`: 上一张图像
- ✅ `D` / `→`: 下一张图像
- ✅ `Space + 拖拽`: 平移画布
- ✅ `H`: 隐藏/显示标注
- ✅ `Del` / `Backspace`: 删除选中标注
- ✅ `Ctrl+Z`: 撤销
- ✅ `Ctrl+Shift+Z`: 重做
- ✅ `Ctrl+S`: 手动保存
- ✅ `Esc`: 取消当前操作
- ✅ `Enter`: 完成多边形绘制

#### 11. 图像导航
- ✅ 键盘导航（A/D 或方向键）
- ✅ 文件列表导航
- ✅ 自动保存当前标注
- ✅ 切换图像时加载标注

#### 12. 实时更新
- ✅ WebSocket 连接
- ✅ 新图像到达通知
- ✅ 自动刷新图像列表

## 🔄 部分实现功能

### 标注编辑
- ⚠️ 选中后的拖拽调整（矩形框边缘/角点）
- ⚠️ 多边形顶点拖拽调整
- ⚠️ 修改标注类别

### 撤销/重做
- ⚠️ 基础框架已实现，但需要完善状态管理

## ❌ 待实现功能

### 高级标注功能
- 标注模板/预设
- 标注复制/粘贴
- 标注分组
- 标注标签/备注

### 批量操作
- 批量删除标注
- 批量修改类别
- 批量导出选择

### 协作功能
- 多人实时协作标注
- 标注权限管理
- 标注审核流程

### 用户管理
- 用户注册/登录
- 用户权限控制
- 项目访问控制

### 导入功能
- 从 COCO 格式导入
- 从 Pascal VOC 格式导入
- 从其他标注工具导入

### 高级功能
- 标注统计和分析
- 标注质量评估
- 自动标注建议（需要 AI 模型）
- 图像增强功能

### UI/UX 改进
- 标注动画效果
- 更丰富的视觉反馈
- 标注历史记录查看
- 快捷键自定义配置
- 主题切换（暗色/亮色）

### 性能优化
- 大图像优化加载
- 标注数据分页
- 图像缩略图缓存
- 前端状态管理优化

## 技术债务

1. **安全性**
   - 添加输入验证和清理
   - 添加文件上传大小限制
   - 添加路径遍历攻击防护
   - 添加 CORS 配置（生产环境）

2. **错误处理**
   - 完善错误消息提示
   - 添加错误日志记录
   - 添加前端错误边界

3. **测试**
   - 单元测试
   - 集成测试
   - E2E 测试

4. **文档**
   - API 文档（Swagger/OpenAPI）
   - 代码注释完善

5. **性能**
   - 数据库查询优化
   - 图像加载优化
   - Canvas 渲染优化

## 已知问题

1. Canvas 组件在某些情况下可能无法正确加载图像
2. 多边形标注的顶点编辑功能未完全实现
3. 关键点标注的骨架连接需要配置
4. WebSocket 重连机制需要完善

## 未来规划

1. **短期**（1-2 周）
   - 完善标注编辑功能
   - 添加标注导入功能
   - 优化 UI/UX

2. **中期**（1-2 月）
   - 添加用户认证
   - 实现协作功能
   - 添加统计分析

3. **长期**（3-6 月）
   - AI 辅助标注
   - 移动端支持
   - 云端部署方案

